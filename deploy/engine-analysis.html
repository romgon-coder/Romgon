<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Engine Analysis - ROMGON</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1f2e 0%, #2d1b3d 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #a0a0a0;
            font-size: 1.1rem;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 12px;
        }

        .tab-btn {
            padding: 12px 24px;
            background: rgba(102, 126, 234, 0.2);
            border: 2px solid rgba(102, 126, 234, 0.4);
            border-radius: 8px;
            color: #e0e0e0;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .tab-btn:hover {
            background: rgba(102, 126, 234, 0.4);
            border-color: rgba(102, 126, 234, 0.6);
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #667eea;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 16px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-icon {
            font-size: 1.5rem;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: #a0a0a0;
        }

        .stat-value {
            color: #fff;
            font-weight: 600;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-ok {
            background: rgba(46, 213, 115, 0.2);
            color: #2ed573;
            border: 1px solid rgba(46, 213, 115, 0.4);
        }

        .status-warning {
            background: rgba(255, 159, 64, 0.2);
            color: #ff9f40;
            border: 1px solid rgba(255, 159, 64, 0.4);
        }

        .status-error {
            background: rgba(255, 71, 87, 0.2);
            color: #ff4757;
            border: 1px solid rgba(255, 71, 87, 0.4);
        }

        .status-info {
            background: rgba(54, 162, 235, 0.2);
            color: #36a2eb;
            border: 1px solid rgba(54, 162, 235, 0.4);
        }

        .refresh-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #a0a0a0;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .recommendation-card {
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid #667eea;
            padding: 16px;
            margin-bottom: 16px;
            border-radius: 8px;
        }

        .recommendation-card h4 {
            color: #667eea;
            margin-bottom: 8px;
        }

        .recommendation-card .priority {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .priority-high {
            background: rgba(255, 71, 87, 0.3);
            color: #ff4757;
        }

        .priority-medium {
            background: rgba(255, 159, 64, 0.3);
            color: #ff9f40;
        }

        .priority-low {
            background: rgba(46, 213, 115, 0.3);
            color: #2ed573;
        }

        .priority-info {
            background: rgba(54, 162, 235, 0.3);
            color: #36a2eb;
        }

        .test-result {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            margin-bottom: 12px;
        }

        .test-icon {
            font-size: 1.5rem;
        }

        .test-info {
            flex: 1;
        }

        .test-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .test-message {
            color: #a0a0a0;
            font-size: 0.9rem;
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            margin-bottom: 12px;
        }

        .connection-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .connection-dot.connected {
            background: #2ed573;
            box-shadow: 0 0 10px rgba(46, 213, 115, 0.5);
        }

        .connection-dot.error {
            background: #ff4757;
            box-shadow: 0 0 10px rgba(255, 71, 87, 0.5);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-5px);
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.03);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .bar-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .bar-label {
            min-width: 120px;
            color: #a0a0a0;
        }

        .bar-visual {
            flex: 1;
            height: 30px;
            background: rgba(102, 126, 234, 0.3);
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }

        .bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.6s ease;
        }

        .bar-value {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-btn">‚Üê Back to Game</a>

    <div class="container">
        <header>
            <h1>üîß Engine Analysis Dashboard</h1>
            <p class="subtitle">Monitor, optimize, and diagnose the ROMGON game engine</p>
        </header>

        <div class="nav-tabs">
            <button class="tab-btn active" data-tab="overview">Overview</button>
            <button class="tab-btn" data-tab="health">Health Check</button>
            <button class="tab-btn" data-tab="performance">Performance</button>
            <button class="tab-btn" data-tab="connections">Connections</button>
            <button class="tab-btn" data-tab="diagnostics">Diagnostics</button>
            <button class="tab-btn" data-tab="optimize">Optimization</button>
        </div>

        <!-- Overview Tab -->
        <div id="overview-tab" class="tab-content active">
            <button class="refresh-btn" onclick="loadOverview()">üîÑ Refresh Overview</button>
            
            <div class="card-grid" id="overview-stats">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Loading engine statistics...</p>
                </div>
            </div>

            <div class="chart-container">
                <h3>Game Status Distribution</h3>
                <div class="bar-chart" id="games-chart"></div>
            </div>
        </div>

        <!-- Health Check Tab -->
        <div id="health-tab" class="tab-content">
            <button class="refresh-btn" onclick="loadHealth()">üîÑ Refresh Health</button>
            
            <div class="card-grid" id="health-checks">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Running health checks...</p>
                </div>
            </div>
        </div>

        <!-- Performance Tab -->
        <div id="performance-tab" class="tab-content">
            <button class="refresh-btn" onclick="loadPerformance()">üîÑ Refresh Performance</button>
            
            <div id="performance-metrics">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Analyzing performance...</p>
                </div>
            </div>
        </div>

        <!-- Connections Tab -->
        <div id="connections-tab" class="tab-content">
            <button class="refresh-btn" onclick="loadConnections()">üîÑ Refresh Connections</button>
            
            <div class="card-grid" id="connections-status">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Checking connections...</p>
                </div>
            </div>
        </div>

        <!-- Diagnostics Tab -->
        <div id="diagnostics-tab" class="tab-content">
            <button class="refresh-btn" onclick="loadDiagnostics()">üîÑ Run Diagnostics</button>
            
            <div id="diagnostics-results">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Running diagnostic tests...</p>
                </div>
            </div>
        </div>

        <!-- Optimization Tab -->
        <div id="optimize-tab" class="tab-content">
            <button class="refresh-btn" onclick="loadOptimizations()">üîÑ Refresh Suggestions</button>
            
            <div id="optimization-suggestions">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Analyzing optimization opportunities...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'https://api.romgon.net/api/engine';

        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tabName = btn.dataset.tab;
                
                // Update active states
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                btn.classList.add('active');
                document.getElementById(`${tabName}-tab`).classList.add('active');
                
                // Load data for tab if not already loaded
                switch(tabName) {
                    case 'overview': loadOverview(); break;
                    case 'health': loadHealth(); break;
                    case 'performance': loadPerformance(); break;
                    case 'connections': loadConnections(); break;
                    case 'diagnostics': loadDiagnostics(); break;
                    case 'optimize': loadOptimizations(); break;
                }
            });
        });

        // Load Overview
        async function loadOverview() {
            try {
                const response = await fetch(`${API_BASE}/stats`);
                const data = await response.json();
                
                const container = document.getElementById('overview-stats');
                container.innerHTML = `
                    <div class="card">
                        <h3><span class="card-icon">üéÆ</span> Games</h3>
                        <div class="stat-row">
                            <span class="stat-label">Total Games</span>
                            <span class="stat-value">${data.totalGames || 0}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Games (24h)</span>
                            <span class="stat-value">${data.gamesLast24h || 0}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Avg Moves/Game</span>
                            <span class="stat-value">${data.avgMovesPerGame || 0}</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">üë•</span> Users</h3>
                        <div class="stat-row">
                            <span class="stat-label">Total Users</span>
                            <span class="stat-value">${data.totalUsers || 0}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Active (7d)</span>
                            <span class="stat-value">${data.activeUsers || 0}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Activity Rate</span>
                            <span class="stat-value">${data.totalUsers > 0 ? Math.round(data.activeUsers / data.totalUsers * 100) : 0}%</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">üé®</span> Custom Games</h3>
                        <div class="stat-row">
                            <span class="stat-label">Total Created</span>
                            <span class="stat-value">${data.totalCustomGames || 0}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Published</span>
                            <span class="stat-value">${data.publishedCustomGames || 0}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Publish Rate</span>
                            <span class="stat-value">${data.totalCustomGames > 0 ? Math.round(data.publishedCustomGames / data.totalCustomGames * 100) : 0}%</span>
                        </div>
                    </div>
                `;

                // Update chart
                if (data.gamesByStatus) {
                    const chartContainer = document.getElementById('games-chart');
                    const total = Object.values(data.gamesByStatus).reduce((a, b) => a + b, 0);
                    
                    chartContainer.innerHTML = Object.entries(data.gamesByStatus)
                        .map(([status, count]) => `
                            <div class="bar-row">
                                <span class="bar-label">${status.charAt(0).toUpperCase() + status.slice(1)}</span>
                                <div class="bar-visual">
                                    <div class="bar-fill" style="width: ${total > 0 ? (count / total * 100) : 0}%"></div>
                                    <span class="bar-value">${count}</span>
                                </div>
                            </div>
                        `).join('');
                }
            } catch (error) {
                document.getElementById('overview-stats').innerHTML = `
                    <div class="card">
                        <h3>Error</h3>
                        <p style="color: #ff4757;">Failed to load statistics: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Load Health
        async function loadHealth() {
            try {
                const response = await fetch(`${API_BASE}/health`);
                const data = await response.json();
                
                const container = document.getElementById('health-checks');
                container.innerHTML = `
                    <div class="card">
                        <h3><span class="card-icon">üíö</span> System Status</h3>
                        <div class="stat-row">
                            <span class="stat-label">Overall Status</span>
                            <span class="stat-value"><span class="status-badge status-${data.status === 'healthy' ? 'ok' : 'warning'}">${data.status}</span></span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Timestamp</span>
                            <span class="stat-value">${new Date(data.timestamp).toLocaleString()}</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">üíæ</span> Database</h3>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value"><span class="status-badge status-${data.checks.database?.status === 'ok' ? 'ok' : 'error'}">${data.checks.database?.status || 'unknown'}</span></span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Tables</span>
                            <span class="stat-value">${data.checks.schema?.count || 0}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Responsive</span>
                            <span class="stat-value">${data.checks.database?.responsive ? '‚úÖ Yes' : '‚ùå No'}</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">üß†</span> Memory</h3>
                        <div class="stat-row">
                            <span class="stat-label">Heap Used</span>
                            <span class="stat-value">${data.checks.memory?.heapUsed || 'N/A'}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Heap Total</span>
                            <span class="stat-value">${data.checks.memory?.heapTotal || 'N/A'}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">RSS</span>
                            <span class="stat-value">${data.checks.memory?.rss || 'N/A'}</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">‚è±Ô∏è</span> Uptime</h3>
                        <div class="stat-row">
                            <span class="stat-label">Duration</span>
                            <span class="stat-value">${data.checks.uptime?.formatted || 'N/A'}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Seconds</span>
                            <span class="stat-value">${data.checks.uptime?.seconds || 0}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value"><span class="status-badge status-ok">Running</span></span>
                        </div>
                    </div>
                `;
            } catch (error) {
                document.getElementById('health-checks').innerHTML = `
                    <div class="card">
                        <h3>Error</h3>
                        <p style="color: #ff4757;">Failed to load health status: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Load Performance
        async function loadPerformance() {
            try {
                const response = await fetch(`${API_BASE}/performance`);
                const data = await response.json();
                
                const container = document.getElementById('performance-metrics');
                let queriesHtml = '';
                
                if (data.queries) {
                    queriesHtml = Object.entries(data.queries).map(([name, query]) => `
                        <div class="test-result">
                            <span class="test-icon">${query.status === 'excellent' ? 'üü¢' : query.status === 'good' ? 'üü°' : 'üî¥'}</span>
                            <div class="test-info">
                                <div class="test-name">${name.replace(/_/g, ' ').toUpperCase()}</div>
                                <div class="test-message">${query.description} - ${query.duration_ms}ms (${query.status})</div>
                            </div>
                        </div>
                    `).join('');
                }
                
                container.innerHTML = `
                    <div class="card-grid">
                        <div class="card">
                            <h3><span class="card-icon">üíæ</span> Database</h3>
                            <div class="stat-row">
                                <span class="stat-label">Size</span>
                                <span class="stat-value">${data.database?.size || 'N/A'}</span>
                            </div>
                            <div class="stat-row">
                                <span class="stat-label">Indexes</span>
                                <span class="stat-value">${data.database?.indexes || 0}</span>
                            </div>
                        </div>

                        <div class="card">
                            <h3><span class="card-icon">‚öôÔ∏è</span> Node.js</h3>
                            <div class="stat-row">
                                <span class="stat-label">Version</span>
                                <span class="stat-value">${data.nodejs?.version || 'N/A'}</span>
                            </div>
                            <div class="stat-row">
                                <span class="stat-label">Platform</span>
                                <span class="stat-value">${data.nodejs?.platform || 'N/A'}</span>
                            </div>
                            <div class="stat-row">
                                <span class="stat-label">Architecture</span>
                                <span class="stat-value">${data.nodejs?.arch || 'N/A'}</span>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">‚ö°</span> Query Performance</h3>
                        ${queriesHtml}
                    </div>
                `;
            } catch (error) {
                document.getElementById('performance-metrics').innerHTML = `
                    <div class="card">
                        <h3>Error</h3>
                        <p style="color: #ff4757;">Failed to load performance metrics: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Load Connections
        async function loadConnections() {
            try {
                const response = await fetch(`${API_BASE}/connections`);
                const data = await response.json();
                
                const container = document.getElementById('connections-status');
                let html = '';
                
                if (data.services) {
                    html = Object.entries(data.services).map(([name, service]) => `
                        <div class="card">
                            <h3><span class="card-icon">üîå</span> ${name.replace(/([A-Z])/g, ' $1').trim()}</h3>
                            <div class="connection-status">
                                <div class="connection-dot ${service.status === 'connected' ? 'connected' : 'error'}"></div>
                                <span class="stat-value">${service.status.toUpperCase()}</span>
                            </div>
                            ${service.total !== undefined ? `
                                <div class="stat-row">
                                    <span class="stat-label">Total Records</span>
                                    <span class="stat-value">${service.total}</span>
                                </div>
                            ` : ''}
                            ${service.recent !== undefined ? `
                                <div class="stat-row">
                                    <span class="stat-label">Recent (7d)</span>
                                    <span class="stat-value">${service.recent}</span>
                                </div>
                            ` : ''}
                            ${service.activeGames !== undefined ? `
                                <div class="stat-row">
                                    <span class="stat-label">Active Games</span>
                                    <span class="stat-value">${service.activeGames}</span>
                                </div>
                            ` : ''}
                            ${service.totalUsers !== undefined ? `
                                <div class="stat-row">
                                    <span class="stat-label">Total Users</span>
                                    <span class="stat-value">${service.totalUsers}</span>
                                </div>
                            ` : ''}
                            ${service.totalRatings !== undefined ? `
                                <div class="stat-row">
                                    <span class="stat-label">Total Ratings</span>
                                    <span class="stat-value">${service.totalRatings}</span>
                                </div>
                            ` : ''}
                            ${service.activeConnections !== undefined ? `
                                <div class="stat-row">
                                    <span class="stat-label">Active Connections</span>
                                    <span class="stat-value">${service.activeConnections}</span>
                                </div>
                            ` : ''}
                            <div class="stat-row">
                                <span class="stat-label">Integration</span>
                                <span class="stat-value"><span class="status-badge status-ok">${service.integration || 'unknown'}</span></span>
                            </div>
                        </div>
                    `).join('');
                }
                
                container.innerHTML = html;
            } catch (error) {
                document.getElementById('connections-status').innerHTML = `
                    <div class="card">
                        <h3>Error</h3>
                        <p style="color: #ff4757;">Failed to load connections: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Load Diagnostics
        async function loadDiagnostics() {
            try {
                const response = await fetch(`${API_BASE}/diagnostics`);
                const data = await response.json();
                
                const container = document.getElementById('diagnostics-results');
                
                let testsHtml = '';
                if (data.tests) {
                    testsHtml = data.tests.map(test => `
                        <div class="test-result">
                            <span class="test-icon">${test.status === 'passed' ? '‚úÖ' : test.status === 'warning' ? '‚ö†Ô∏è' : '‚ùå'}</span>
                            <div class="test-info">
                                <div class="test-name">${test.name}</div>
                                <div class="test-message">${test.message}</div>
                                ${test.recommendation ? `<div class="test-message" style="color: #667eea;">üí° ${test.recommendation}</div>` : ''}
                            </div>
                        </div>
                    `).join('');
                }
                
                container.innerHTML = `
                    <div class="card">
                        <h3><span class="card-icon">üîç</span> Diagnostic Results</h3>
                        <div class="stat-row">
                            <span class="stat-label">Overall Status</span>
                            <span class="stat-value"><span class="status-badge status-${data.overall === 'healthy' ? 'ok' : data.overall === 'warnings' ? 'warning' : 'error'}">${data.overall}</span></span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Tests Run</span>
                            <span class="stat-value">${data.tests?.length || 0}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Timestamp</span>
                            <span class="stat-value">${new Date(data.timestamp).toLocaleString()}</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">üìã</span> Test Results</h3>
                        ${testsHtml}
                    </div>
                `;
            } catch (error) {
                document.getElementById('diagnostics-results').innerHTML = `
                    <div class="card">
                        <h3>Error</h3>
                        <p style="color: #ff4757;">Failed to run diagnostics: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Load Optimizations
        async function loadOptimizations() {
            try {
                const response = await fetch(`${API_BASE}/optimize`);
                const data = await response.json();
                
                const container = document.getElementById('optimization-suggestions');
                
                let suggestionsHtml = '';
                if (data.recommendations) {
                    suggestionsHtml = data.recommendations.map(rec => `
                        <div class="recommendation-card">
                            <span class="priority priority-${rec.priority}">${rec.priority.toUpperCase()}</span>
                            <h4>${rec.title}</h4>
                            <p style="color: #a0a0a0; margin-bottom: 8px;">${rec.description}</p>
                            <p style="color: #667eea;"><strong>üí° Recommendation:</strong> ${rec.recommendation}</p>
                            <p style="color: #2ed573; margin-top: 8px;"><strong>üìà Impact:</strong> ${rec.impact}</p>
                        </div>
                    `).join('');
                }
                
                container.innerHTML = `
                    <div class="card">
                        <h3><span class="card-icon">üöÄ</span> Optimization Suggestions</h3>
                        <div class="stat-row">
                            <span class="stat-label">Recommendations</span>
                            <span class="stat-value">${data.recommendations?.length || 0}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Timestamp</span>
                            <span class="stat-value">${new Date(data.timestamp).toLocaleString()}</span>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        ${suggestionsHtml}
                    </div>
                `;
            } catch (error) {
                document.getElementById('optimization-suggestions').innerHTML = `
                    <div class="card">
                        <h3>Error</h3>
                        <p style="color: #ff4757;">Failed to load optimization suggestions: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Load initial data
        loadOverview();
    </script>
</body>
</html>
