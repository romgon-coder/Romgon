# ğŸ—ºï¸ Visual Game Flow Map - ROMGON

## ğŸ¯ MAIN GAME LOOP (Visual Flow)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ROMGON GAME ENGINE                       â”‚
â”‚                   (public/index.html)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LOBBY (Line ~7300)                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚âš”ï¸ PvP    â”‚  â”‚ğŸ¤– vs AI  â”‚  â”‚ğŸ› ï¸ Practiceâ”‚  â”‚â±ï¸ Timed  â”‚  â”‚
â”‚  â”‚Local     â”‚  â”‚         â”‚  â”‚         â”‚  â”‚         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚             â”‚             â”‚
        â”‚             â”‚             â”‚             â”‚
        â–¼             â–¼             â–¼             â–¼
   Line 16680    Line 19835    Line 16804    Line 16680
startPvPLocal()  startAIGame() startSandbox() startWithTime()
        â”‚             â”‚             â”‚             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  initializeBoard()      â”‚
         â”‚  (Line 16144)           â”‚
         â”‚  â€¢ Creates 51 hexagons  â”‚
         â”‚  â€¢ Places pieces        â”‚
         â”‚  â€¢ Sets up listeners    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  setupDragAndDrop()     â”‚
         â”‚  (Line ~15990)          â”‚
         â”‚  â€¢ Enable piece draggingâ”‚
         â”‚  â€¢ Highlight system     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  GAME ACTIVE            â”‚
         â”‚  gameInProgress = true  â”‚
         â”‚  currentPlayer = 'black'â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
            WAITING FOR INPUT...
```

---

## ğŸ® MOVE EXECUTION FLOW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PLAYER CLICKS & DRAGS PIECE                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  dragstart EVENT        â”‚
        â”‚  (Line 15998)           â”‚
        â”‚  â€¢ Store draggedPiece   â”‚
        â”‚  â€¢ Store draggedFromHex â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  highlightValidMoves()  â”‚
        â”‚  â€¢ Show legal moves     â”‚
        â”‚  â€¢ Green highlighting   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PLAYER DROPS ON TARGET HEX                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  drop EVENT             â”‚
        â”‚  (Line 27533)           â”‚
        â”‚  â€¢ Main move handler    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  validateMove()         â”‚
        â”‚  â€¢ Check piece pattern  â”‚
        â”‚  â€¢ Check path clear     â”‚
        â”‚  â€¢ Check player turn    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
               â”Œâ”€â”€â”€â”´â”€â”€â”€â”
               â”‚ Valid?â”‚
               â””â”€â”€â”€â”¬â”€â”€â”€â”˜
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
           â”‚               â”‚
          NO              YES
           â”‚               â”‚
           â–¼               â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ REJECT  â”‚   â”‚ EXECUTE MOVE   â”‚
     â”‚ Move    â”‚   â”‚ â€¢ Move DOM     â”‚
     â”‚ Return  â”‚   â”‚ â€¢ Check captureâ”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Capture Opponent?    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”Œâ”€â”€â”€â”´â”€â”€â”€â”
                       â”‚  Any? â”‚
                       â””â”€â”€â”€â”¬â”€â”€â”€â”˜
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
                  YES              NO
                   â”‚               â”‚
                   â–¼               â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ removePiece()â”‚   â”‚ Continue â”‚
         â”‚ addToElim()  â”‚   â”‚          â”‚
         â”‚ playCapture()â”‚   â”‚          â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚ recordMoveRPN()        â”‚
             â”‚ â€¢ Save to history      â”‚
             â”‚ â€¢ Update notation      â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚ highlightLastMove()    â”‚
             â”‚ â€¢ Visual feedback      â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚ playMoveSound()        â”‚
             â”‚ â€¢ Audio feedback       â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚ checkWinConditions()   â”‚
             â”‚ (Line 25426)           â”‚
             â”‚ â€¢ Base capture?        â”‚
             â”‚ â€¢ King capture?        â”‚
             â”‚ â€¢ Stalemate?           â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                    â”Œâ”€â”€â”€â”´â”€â”€â”€â”
                    â”‚ Won?  â”‚
                    â””â”€â”€â”€â”¬â”€â”€â”€â”˜
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
               YES              NO
                â”‚               â”‚
                â–¼               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ GAME OVER       â”‚  â”‚ switchTurn() â”‚
      â”‚ â€¢ gameOver=true â”‚  â”‚ (Line 23367) â”‚
      â”‚ â€¢ Show modal    â”‚  â”‚ â€¢ Next playerâ”‚
      â”‚ â€¢ Play sound    â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚ â€¢ Disable moves â”‚         â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ AI Enabled?    â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”Œâ”€â”€â”€â”´â”€â”€â”€â”
                             YES      NO
                              â”‚       â”‚
                              â–¼       â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”
                     â”‚makeAIMoveâ”‚  â”‚ Wait â”‚
                     â”‚(21442)   â”‚  â”‚ for  â”‚
                     â”‚          â”‚  â”‚ inputâ”‚
                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â””â”€â”€> Back to top (AI executes move)
```

---

## ğŸ† WIN CONDITION CHECK FLOW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  checkWinConditions(row, col, piece)          â”‚
â”‚  (Line 25426)                                  â”‚
â”‚  Called AFTER every move                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  CHECK 1: Base Capture  â”‚
        â”‚  â€¢ Is piece Rhombus?    â”‚
        â”‚  â€¢ In opponent's base?  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
               â”Œâ”€â”€â”€â”´â”€â”€â”€â”
               â”‚ Base? â”‚
               â””â”€â”€â”€â”¬â”€â”€â”€â”˜
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
          YES              NO
           â”‚               â”‚
           â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ WIN!       â”‚   â”‚ CHECK 2:       â”‚
    â”‚ Return     â”‚   â”‚ Rhombus Capture   â”‚
    â”‚ Winner     â”‚   â”‚ â€¢ Count pieces â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â€¢ All 6 gone?  â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                         â”Œâ”€â”€â”€â”´â”€â”€â”€â”
                         â”‚ All?  â”‚
                         â””â”€â”€â”€â”¬â”€â”€â”€â”˜
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
                    YES              NO
                     â”‚               â”‚
                     â–¼               â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ WIN!       â”‚   â”‚ CHECK 3:       â”‚
              â”‚ Return     â”‚   â”‚ Stalemate      â”‚
              â”‚ Winner     â”‚   â”‚ â€¢ Can opp move?â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                   â”Œâ”€â”€â”€â”´â”€â”€â”€â”
                                   â”‚ Can't?â”‚
                                   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
                              YES              NO
                               â”‚               â”‚
                               â–¼               â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ DRAW!      â”‚   â”‚ Continue   â”‚
                        â”‚ Stalemate  â”‚   â”‚ Game is on â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ UI PANEL HIERARCHY

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BROWSER WINDOW                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  LOBBY (#start-menu) Line ~7300                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”       â”‚ â”‚
â”‚  â”‚  â”‚ PvP  â”‚ â”‚  AI  â”‚ â”‚Pract â”‚ â”‚Timer â”‚ â”‚Varia â”‚       â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚
â”‚  â”‚  (Buttons trigger game modes)                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  WHEN GAME STARTS, LOBBY HIDES AND BOARD SHOWS:            â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  GAME SCREEN (#board-display-container) Line 10650   â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        HEX BOARD         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚  â”‚  â”‚ White       â”‚        â•± â•²  â•± â•²          â”‚ Black  â”‚â”‚ â”‚
â”‚  â”‚  â”‚ Eliminated  â”‚      â•±   â•²â•±   â•²          â”‚ Elim   â”‚â”‚ â”‚
â”‚  â”‚  â”‚ Pieces      â”‚     â”‚ â¬¡  â¬¡  â¬¡ â”‚          â”‚ Pieces â”‚â”‚ â”‚
â”‚  â”‚  â”‚ (~10670)    â”‚    â•± â¬¡  â¬¡  â¬¡  â¬¡â•²         â”‚(10670) â”‚â”‚ â”‚
â”‚  â”‚  â”‚             â”‚   â”‚ â¬¡  â¬¡  â¬¡  â¬¡  â¬¡â”‚        â”‚        â”‚â”‚ â”‚
â”‚  â”‚  â”‚ â–³ â–¡ â—‹       â”‚  â•± â¬¡  â¬¡  â¬¡  â¬¡  â¬¡ â•²       â”‚ â–² â–  â—  â”‚â”‚ â”‚
â”‚  â”‚  â”‚             â”‚ â”‚ â¬¡  â¬¡  â¬¡  â¬¡  â¬¡  â¬¡ â”‚      â”‚        â”‚â”‚ â”‚
â”‚  â”‚  â”‚ Move List:  â”‚  â•² â¬¡  â¬¡  â¬¡  â¬¡  â¬¡ â•±       â”‚ Move   â”‚â”‚ â”‚
â”‚  â”‚  â”‚ 1. d3â†’d4    â”‚   â”‚ â¬¡  â¬¡  â¬¡  â¬¡  â¬¡â”‚        â”‚ List   â”‚â”‚ â”‚
â”‚  â”‚  â”‚ 2. c5â†’d5    â”‚    â•² â¬¡  â¬¡  â¬¡  â¬¡ â•±         â”‚        â”‚â”‚ â”‚
â”‚  â”‚  â”‚             â”‚     â”‚ â¬¡  â¬¡  â¬¡ â”‚          â”‚        â”‚â”‚ â”‚
â”‚  â”‚  â”‚             â”‚      â•² â¬¡  â¬¡  â•±            â”‚        â”‚â”‚ â”‚
â”‚  â”‚  â”‚             â”‚       â•²  â•±  â•±             â”‚        â”‚â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  [Quit Game]  Turn: Black â–¼  [Timer: 10:00]         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  FLOATING PANELS (Can drag anywhere):                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ ğŸ› ï¸ SANDBOX PANEL â”‚        â”‚ ğŸ¥ CAMERA PANEL  â”‚         â”‚
â”‚  â”‚ (~10695)         â”‚        â”‚ (~12800)         â”‚         â”‚
â”‚  â”‚ â€¢ Edit Mode      â”‚        â”‚ â€¢ Rotation       â”‚         â”‚
â”‚  â”‚ â€¢ Play Mode      â”‚        â”‚ â€¢ Tilt           â”‚         â”‚
â”‚  â”‚ â€¢ Piece Selector â”‚        â”‚ â€¢ Zoom           â”‚         â”‚
â”‚  â”‚ â€¢ Reset Board    â”‚        â”‚ â€¢ Presets        â”‚         â”‚
â”‚  â”‚ â€¢ Save Position  â”‚        â”‚ â€¢ Reset          â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  (Sandbox mode only)         (When 3D enabled)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§© PIECE INTERACTION MAP

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PIECE TYPES & INTERACTIONS                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Triangle (â–³/â–²)
â”œâ”€ Movement: Forward only (1 space)
â”œâ”€ Capture: Same as movement âœ…
â”œâ”€ Special: First move can be 2 spaces
â””â”€ Search: "triangle-piece"

Square (â–¡/â– )
â”œâ”€ Movement: Any direction (1 space)
â”œâ”€ Capture: Same as movement âœ…
â”œâ”€ Special: Most versatile
â””â”€ Search: "square-piece"

Circle (â—‹/â—)
â”œâ”€ Movement: Orthogonal (straight lines)
â”œâ”€ Capture: Same as movement âœ…
â”œâ”€ Special: Long-range
â””â”€ Search: "circle-piece"

Hexagon (â¬¡/â¬¢) âš ï¸ NO ESCAPE MOVES
â”œâ”€ Movement: 6-directional pattern (rotation-dependent)
â”œâ”€ Capture: Same as movement âœ… (uses getRotatedHexgonTargets)
â”œâ”€ Special: Can rotate, wins by reaching opponent base
â”œâ”€ Attack Function: canHexgonAttack() â†’ Line 14224
â”œâ”€ Movement Function: showHexgonMovementPattern() â†’ Line 28003
â”œâ”€ Shared Logic: getRotatedHexgonTargets() â†’ Line 22306
â””â”€ Search: "hexgon-piece"

Rhombus (â—‡/â—†) âš ï¸ HAS ESCAPE MOVES
â”œâ”€ Movement: Diagonal + escape moves (Dead Zone â†” Inner Perimeter)
â”œâ”€ Capture: Diagonal only âŒ (EXCLUDES diagonal escape moves)
â”œâ”€ Special: Long-range diagonal, escape-only moves
â”œâ”€ Attack Function: canRhombusAttack() â†’ Line 14249 (blocks diagonal escapes)
â”œâ”€ Movement Function: showRhombusMovementPattern() â†’ Line 15069
â”œâ”€ Escape Implementation: Search "isDiagonalMove" in canRhombusAttack
â””â”€ Search: "rhombus-piece"
```

### âš ï¸ CRITICAL DISTINCTION: Attack vs Movement

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ATTACK = MOVEMENT?                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Triangle  â”‚ âœ… YES â”‚ Same patterns                       â”‚
â”‚  Square    â”‚ âœ… YES â”‚ Same patterns                       â”‚
â”‚  Circle    â”‚ âœ… YES â”‚ Same patterns                       â”‚
â”‚  Hexagon   â”‚ âœ… YES â”‚ Both use getRotatedHexgonTargets() â”‚
â”‚  Rhombus   â”‚ âŒ NO  â”‚ Has diagonal ESCAPE moves         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

HEXAGON RULE: Movement and attack are IDENTICAL
- No escape-only moves exist
- All moves shown can also attack
- getRotatedHexgonTargets() used for both

RHOMBUS EXCEPTION: Movement includes escape-only moves  
- Dead Zone (3-3, 3-4, 3-5) â†” Inner Perimeter diagonal jumps
- These moves CANNOT be used for attack
- canRhombusAttack() specifically blocks diagonal escapes
```

---

## ğŸ¯ COMMON TASK ROADMAP

### **TASK: Change How Triangles Move**
```
Step 1: Open public/index.html
        â†“
Step 2: Search "triangle-piece"
        â†“
Step 3: Find movement validation (~line TBD)
        â†“
Step 4: Locate move offset array
        Example: [[1,0], [1,1], ...] 
        â†“
Step 5: Modify offsets
        â†“
Step 6: Save & test in Sandbox mode
        â†“
Step 7: If works, test in PvP mode
```

### **TASK: Add New Button to Sandbox Panel**
```
Step 1: Open public/index.html
        â†“
Step 2: Go to line ~10746 (sandbox buttons)
        â†“
Step 3: Copy existing button HTML
        â†“
Step 4: Paste & modify:
        <button onclick="myNewFunction()">
            ğŸ†• My Button
        </button>
        â†“
Step 5: Define function below:
        function myNewFunction() {
            // Your code here
        }
        â†“
Step 6: Test in Practice mode
```

### **TASK: Change Win Condition**
```
Step 1: Open public/index.html
        â†“
Step 2: Go to line 25426 (checkWinConditions)
        â†“
Step 3: Add new check:
        if (yourCondition) {
            return {winner: player, reason: 'desc'};
        }
        â†“
Step 4: Test by creating winning position
```

---

## ğŸ” LINE NUMBER QUICK REFERENCE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CRITICAL LINE NUMBERS                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Lobby Menu................... ~7300   â”‚
â”‚  Eliminated Panels............ ~10670  â”‚
â”‚  Board Container.............. ~10650  â”‚
â”‚  Sandbox Panel................ ~10695  â”‚
â”‚  Camera Panel................. ~12800  â”‚
â”‚  Drag Start Event............. ~15998  â”‚
â”‚  Initialize Board............. ~16144  â”‚
â”‚  Start PvP.................... ~16680  â”‚
â”‚  Start Sandbox................ ~16804  â”‚
â”‚  Start AI.................... ~19835  â”‚
â”‚  Make AI Move................ ~21442  â”‚
â”‚  Switch Turn................. ~23367  â”‚
â”‚  Check Win................... ~25426  â”‚
â”‚  Drop Event Handler.......... ~27533  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¬ STEP-BY-STEP GAME SEQUENCE

```
1. Browser loads public/index.html
   â””â”€> Shows lobby (~line 7300)

2. User clicks "âš”ï¸ PvP Local"
   â””â”€> startPvPLocal() called (line 16680)
   
3. Lobby hidden, board shown
   â””â”€> initializeBoard('full') (line 16144)
   
4. 51 hexagons created
   â””â”€> Each has drag/drop listeners
   
5. 7 pieces placed per side
   â””â”€> Black starts first
   
6. Player 1 (Black) drags triangle
   â””â”€> dragstart fires (line 15998)
   â””â”€> Valid moves highlighted
   
7. Player drops on highlighted hex
   â””â”€> drop event fires (line 27533)
   â””â”€> validateMove() checks legality
   â””â”€> Piece DOM moves to new hex
   â””â”€> recordMoveRPN() saves notation
   â””â”€> checkWinConditions() (line 25426)
   â””â”€> No win? switchTurn() (line 23367)
   
8. Now Player 2 (White) turn
   â””â”€> Repeat steps 6-7
   
9. Continue until win condition met
   â””â”€> gameOver = true
   â””â”€> Modal shows winner
   â””â”€> Game ends
```

---

## ğŸ“Š DATA FLOW DIAGRAM

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER INPUT â”‚
â”‚ (Mouse)    â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EVENT SYSTEM   â”‚
â”‚ (Drag & Drop)  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VALIDATION     â”‚â”€â”€â”€â”€>â”‚ Game State   â”‚
â”‚ (Rules Check)  â”‚     â”‚ Variables    â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DOM UPDATE     â”‚
â”‚ (Move Piece)   â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WIN CHECK      â”‚â”€â”€â”€â”€>â”‚ Win Modal    â”‚
â”‚ (3 conditions) â”‚     â”‚ (If true)    â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TURN SWITCH    â”‚
â”‚ (Next player)  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AI CHECK       â”‚
â”‚ (If enabled)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ VISUAL ELEMENT IDs CHEATSHEET

```
CONTAINERS:
#start-menu              â†’ Lobby screen
#board-display-container â†’ Game board wrapper
#eliminated-pieces-container â†’ Captured pieces

PANELS:
#sandbox-tools-panel     â†’ Practice mode controls
#camera-panel            â†’ 3D camera controls
#white-eliminated        â†’ White captured pieces
#black-eliminated        â†’ Black captured pieces
#white-moves             â†’ White move history
#black-moves             â†’ Black move history

BUTTONS (in Lobby):
Inline onclick handlers, search button text

BOARD ELEMENTS:
.hexagon                 â†’ Each hex cell
.triangle-piece          â†’ Triangle pieces
.square-piece            â†’ Square pieces
.circle-piece            â†’ Circle pieces
.hexgon-piece            â†’ Hexagon pieces
.rhombus-piece           â†’ Rhombus pieces
.white-piece             â†’ White pieces
.black-piece             â†’ Black pieces
```

---

**Use this map to navigate the codebase visually!**  
**When lost, come back here to find your bearings.**

**Last Updated:** November 2024  
**Game Engine:** public/index.html (29,891 lines)
